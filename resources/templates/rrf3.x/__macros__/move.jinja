
{% macro rel_move(dx=None, dy=None, dz=0, F=None, cmd='G0', indent=0) %}
{% filter indent(width=indent) %}
; ---- rel_move({{dx}}, {{dy}}, {{dz}}, {{F}}, {{cmd}})
G91
{{cmd}} {{ py.format_gcode_param_str(X=dx, Y=dy, Z=dz, F=F) }}
G90
; ---- rel_move() END
{%- endfilter %}
{% endmacro %}

{% macro avoid_tc_clash(indent=0) -%}
{% filter indent(width=indent) -%}
if move.axes[{{ py.g.axis.Z.index }}].homed && move.axes[{{ py.g.axis.Z.index }}].userPosition < 10 ; if Z < 10
    G1 Z10 ; slowly lower the bed
; ----- AVOID clashing with the TC walls
if move.axes[{{ py.g.axis.Y.index }}].homed && move.axes[{{ py.g.axis.Y.index }}].userPosition > 205 ; if Y > 205 (somewhere in the TC docking area)
    G1 Y200 F2500 ; slowly back out
{%- endfilter %}
{% endmacro %}
